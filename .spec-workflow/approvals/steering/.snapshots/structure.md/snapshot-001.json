{
  "id": "snapshot_1762753332476_f7iqpp8qx",
  "approvalId": "approval_1762753332474_utw0nrvqt",
  "approvalTitle": "Project Structure & Coding Standards - structure.md",
  "version": 1,
  "timestamp": "2025-11-10T05:42:12.476Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Project Structure\n\n## Directory Organization\n\n### 完整專案結構\n\n```\nnuxt4-tailwind-starter/\n├── app/                        # Nuxt 應用主目錄\n│   ├── features/              # Feature-based 模組（核心架構）\n│   │   ├── auth/              # 認證功能模組\n│   │   │   ├── pages/         # Feature 專屬頁面元件\n│   │   │   │   └── LoginPage.vue\n│   │   │   ├── components/    # Feature 專屬 UI 元件\n│   │   │   │   └── LoginForm.vue\n│   │   │   ├── composables/   # Feature 專屬組合式 API\n│   │   │   │   └── useAuth.ts\n│   │   │   ├── store/         # Feature 專屬 Pinia Store\n│   │   │   │   └── auth.store.ts\n│   │   │   ├── api/           # Feature 專屬 API 呼叫\n│   │   │   │   └── auth.api.ts\n│   │   │   ├── types/         # Feature 專屬型別定義\n│   │   │   │   └── auth.types.ts\n│   │   │   ├── __tests__/     # Feature 單元測試\n│   │   │   └── index.ts       # Barrel exports（統一匯出點）\n│   │   └── members/           # 其他 feature 模組（範例）\n│   │       └── ...            # 相同結構\n│   │\n│   ├── pages/                 # Nuxt 檔案式路由\n│   │   ├── index.vue          # 首頁 (/)\n│   │   └── login.vue          # 登入頁 (/login)\n│   │\n│   ├── layouts/               # 頁面版型\n│   │   ├── default.vue        # 預設版型\n│   │   └── README.md\n│   │\n│   ├── shared/                # 跨功能共用程式碼\n│   │   ├── components/        # 共用 UI 元件（Dumb Components）\n│   │   ├── composables/       # 共用組合式 API (useFetch, useModal...)\n│   │   ├── services/          # 共用服務 (API client, logger...)\n│   │   ├── utils/             # 工具函式 (formatters, validators...)\n│   │   └── types/             # 全域型別定義\n│   │\n│   ├── stores/                # 全域 Pinia stores\n│   │   └── index.ts           # Store 入口\n│   │\n│   ├── config/                # 配置檔案\n│   │   └── pwa.ts             # PWA 配置\n│   │\n│   ├── constants/             # 常數定義\n│   │   └── index.ts           # 應用常數 (appName, appDescription...)\n│   │\n│   ├── assets/                # 靜態資源\n│   │   └── css/\n│   │       └── tailwind.css   # Tailwind CSS 入口\n│   │\n│   └── app.vue                # 應用根元件\n│\n├── server/                    # Nuxt Server API routes（選用）\n│   └── api/                   # 伺服器端 API endpoints\n│\n├── public/                    # 公開靜態資源\n│   ├── favicon.ico\n│   ├── pwa-192x192.png\n│   ├── pwa-512x512.png\n│   └── maskable-icon.png\n│\n├── .spec-workflow/            # Spec Workflow MCP 工作目錄\n│   ├── templates/             # 規範模板\n│   ├── specs/                 # 功能規範文檔\n│   ├── steering/              # 專案指導文檔\n│   │   ├── product.md\n│   │   ├── tech.md\n│   │   └── structure.md\n│   └── user-templates/        # 自定義模板\n│\n├── .nuxt/                     # Nuxt 自動生成（不提交）\n├── .output/                   # 建置輸出（不提交）\n├── node_modules/              # 依賴（不提交）\n│\n├── nuxt.config.ts             # Nuxt 配置\n├── tailwind.config.ts         # Tailwind CSS 配置\n├── tsconfig.json              # TypeScript 配置\n├── eslint.config.js           # ESLint 配置\n├── package.json               # 專案依賴與腳本\n├── yarn.lock                  # Yarn 鎖定檔案\n└── README.md                  # 專案說明文檔\n```\n\n### Feature-based 架構原則\n\n**核心理念**: 依功能模組組織代碼，而非技術分層。每個 feature 包含該功能的所有相關代碼。\n\n#### Feature 模組結構規範\n\n每個 feature 目錄（如 `app/features/auth/`）必須包含：\n\n1. **pages/**: Feature 專屬頁面元件\n   - 實作完整的頁面邏輯\n   - 可包含多個頁面（如 LoginPage、RegisterPage）\n   - 透過 barrel exports 匯出供 `app/pages/` 使用\n\n2. **components/**: Feature 專屬 UI 元件\n   - 只給該 feature 使用的元件\n   - 不跨 feature 重用\n   - 如需跨 feature 使用，移至 `app/shared/components/`\n\n3. **composables/**: Feature 專屬組合式 API\n   - 封裝該 feature 的業務邏輯\n   - 狀態管理、副作用處理\n   - 例如：useAuth、useLogin\n\n4. **store/**: Feature 專屬 Pinia Store\n   - 該 feature 的全域狀態\n   - 命名：`[feature].store.ts`\n   - 透過 `useXxxStore()` 訪問\n\n5. **api/**: Feature 專屬 API 呼叫\n   - 封裝與後端互動的函式\n   - 命名：`[feature].api.ts`\n   - 例如：authApi.login(), authApi.logout()\n\n6. **types/**: Feature 專屬型別定義\n   - TypeScript interfaces、types、enums\n   - 命名：`[feature].types.ts`\n   - 透過 barrel exports 匯出\n\n7. **__tests__/**: Feature 單元測試\n   - 對應的測試檔案\n   - 命名：`[filename].test.ts` 或 `[filename].spec.ts`\n\n8. **index.ts**: Barrel exports\n   - 統一匯出該 feature 的 public API\n   - 外部只透過 index.ts 導入\n   - 範例見下方「Barrel Exports 模式」\n\n#### Shared 模組規範\n\n**用途**: 存放可跨 feature 重用的程式碼\n\n- **components/**: 通用 UI 元件（Button、Input、Modal 等）\n- **composables/**: 通用組合式 API（useFetch、useDebounce 等）\n- **services/**: 應用級服務（API client、logger、analytics 等）\n- **utils/**: 純函式工具（formatDate、validateEmail 等）\n- **types/**: 全域型別定義（User、Response 等）\n\n**原則**:\n- 元件應為 Dumb Components（無業務邏輯）\n- 高度可重用性\n- 良好的文檔與範例\n\n### Pages 與 Layouts\n\n#### Pages (檔案式路由)\n\n- **位置**: `app/pages/`\n- **作用**: 定義應用路由結構\n- **原則**:\n  - 頁面檔案應極簡，主要邏輯在 feature pages 中\n  - 從 features 導入頁面元件並組合\n  - 檔案名稱對應路由路徑\n\n**範例**:\n```vue\n<!-- app/pages/login.vue -->\n<script setup lang=\"ts\">\nimport { LoginPage } from '~/features/auth'\n</script>\n\n<template>\n  <LoginPage />\n</template>\n```\n\n**路由對應**:\n- `pages/index.vue` → `/`\n- `pages/login.vue` → `/login`\n- `pages/users/[id].vue` → `/users/:id`（動態路由）\n- `pages/users/index.vue` → `/users`\n\n#### Layouts (版型)\n\n- **位置**: `app/layouts/`\n- **作用**: 定義頁面共用版型\n- **預設**: `default.vue` 為預設版型\n\n**使用方式**:\n```vue\n<script setup lang=\"ts\">\ndefinePageMeta({\n  layout: 'custom' // 使用 layouts/custom.vue\n})\n</script>\n```\n\n## Naming Conventions\n\n### 檔案命名規範\n\n| 檔案類型 | 命名規範 | 範例 |\n|---------|---------|------|\n| **Vue 元件** | PascalCase | `LoginPage.vue`, `LoginForm.vue`, `UserCard.vue` |\n| **Nuxt Pages** | kebab-case | `index.vue`, `login.vue`, `user-profile.vue` |\n| **Layouts** | kebab-case | `default.vue`, `admin.vue`, `auth.vue` |\n| **Composables** | camelCase | `useAuth.ts`, `useFetch.ts`, `useModal.ts` |\n| **Stores** | kebab-case.store.ts | `auth.store.ts`, `user.store.ts` |\n| **API 模組** | kebab-case.api.ts | `auth.api.ts`, `members.api.ts` |\n| **Types** | kebab-case.types.ts | `auth.types.ts`, `user.types.ts` |\n| **Utils** | kebab-case.ts | `date-utils.ts`, `validators.ts` |\n| **Services** | kebab-case.ts | `api-client.ts`, `logger.ts` |\n| **Config** | kebab-case.ts | `pwa.ts`, `i18n.ts` |\n| **Constants** | kebab-case | `index.ts`, `api-endpoints.ts` |\n| **Tests** | [filename].test.ts | `useAuth.test.ts`, `LoginPage.test.ts` |\n\n### 程式碼命名規範\n\n#### TypeScript/JavaScript\n\n| 類型 | 命名規範 | 範例 |\n|-----|---------|------|\n| **Variables** | camelCase | `userName`, `isLoggedIn`, `apiResponse` |\n| **Constants** | UPPER_SNAKE_CASE | `API_BASE_URL`, `MAX_RETRY_COUNT` |\n| **Functions** | camelCase | `getUserData()`, `validateEmail()` |\n| **Classes** | PascalCase | `ApiClient`, `UserService` |\n| **Interfaces** | PascalCase | `User`, `ApiResponse`, `AuthState` |\n| **Types** | PascalCase | `UserId`, `LoginCredentials` |\n| **Enums** | PascalCase | `UserRole`, `ApiStatus` |\n| **Enum Members** | PascalCase | `UserRole.Admin`, `ApiStatus.Success` |\n| **Composables** | use + PascalCase | `useAuth()`, `useFetch()`, `useModal()` |\n| **Store Getters** | PascalCase (function) | `useAuthStore()` |\n\n#### Vue 元件\n\n| 元素 | 命名規範 | 範例 |\n|-----|---------|------|\n| **Component Props** | camelCase | `userName`, `isActive`, `onClick` |\n| **Component Events** | kebab-case | `@user-login`, `@data-updated` |\n| **Component Slots** | kebab-case | `<slot name=\"header\">` |\n| **Refs** | camelCase + Ref | `userRef`, `formRef`, `modalRef` |\n| **Reactive** | camelCase | `state`, `formData`, `filters` |\n\n### 特殊命名規則\n\n#### Barrel Exports (index.ts)\n每個 feature 模組必須包含 `index.ts` 作為統一匯出點：\n\n```typescript\n// app/features/auth/index.ts\n\n// Export composables\nexport { useAuth } from './composables/useAuth'\n\n// Export stores\nexport { useAuthStore } from './store/auth.store'\n\n// Export API\nexport { authApi } from './api/auth.api'\n\n// Export types (type-only)\nexport type * from './types/auth.types'\n\n// Export pages\nexport { default as LoginPage } from './pages/LoginPage.vue'\nexport { default as RegisterPage } from './pages/RegisterPage.vue'\n```\n\n**原則**:\n- 外部只透過 barrel exports 導入\n- 不直接導入內部檔案\n- Type imports 使用 `export type *`\n\n#### Auto-imports 慣例\n\nNuxt 自動導入以下內容（無需手動 import）：\n\n1. **Composables**:\n   - `app/composables/` 目錄下的檔案\n   - Vue 官方 composables（`ref`, `computed`, `watch` 等）\n   - Nuxt composables（`navigateTo`, `useFetch` 等）\n\n2. **Components**:\n   - `app/components/` 目錄下的元件（全域註冊）\n   - 使用 `unplugin-vue-components` 自動導入\n\n3. **Utils**:\n   - `app/utils/` 目錄下的工具函式\n\n**Feature 模組導入**: 需手動 import（使用 `~/features/auth` 路徑別名）\n\n## Import Patterns\n\n### Import 順序規範\n\n透過 ESLint 強制執行以下順序（eslint.config.js:10-26）：\n\n```typescript\n// 1. Node.js 內建模組\nimport path from 'node:path'\nimport fs from 'node:fs'\n\n// 2. External dependencies (npm 套件)\nimport { defineStore } from 'pinia'\nimport { ref, computed } from 'vue'\n\n// 3. Internal imports (專案內部，使用別名)\nimport { useAuth } from '~/features/auth'\nimport { formatDate } from '~/shared/utils'\n\n// 4. Parent directory (../)\nimport { ParentComponent } from '../components'\n\n// 5. Sibling directory (./)\nimport { SiblingComponent } from './components'\n\n// 6. Index imports\nimport utils from './utils'\n\n// 7. Object imports (解構)\nimport type { User } from './types'\n\n// 8. Type imports (TypeScript 類型)\nimport type { Component } from 'vue'\n```\n\n**配置**: `import/order` rule in `eslint.config.js`\n\n### 路徑別名 (Path Aliases)\n\nNuxt 自動配置以下別名：\n\n| 別名 | 對應路徑 | 使用場景 |\n|-----|---------|---------|\n| `~` 或 `@` | `app/` | 從 app 目錄導入 |\n| `~~` 或 `@@` | 專案根目錄 | 從根目錄導入 |\n| `#app` | Nuxt 內建 | Nuxt 核心功能 |\n| `#imports` | Auto-imports | 自動導入的項目 |\n\n**範例**:\n```typescript\n// 從 features 導入\nimport { useAuth } from '~/features/auth'\n\n// 從 shared 導入\nimport { Button } from '~/shared/components'\n\n// 從 config 導入\nimport { pwa } from '~/config/pwa'\n\n// 從根目錄導入（配置檔）\nimport { appName } from '~/constants'\n```\n\n### Module/Package Organization\n\n#### Feature 模組導入規則\n\n**從外部導入 feature**:\n```typescript\n// ✅ 正確：透過 barrel exports\nimport { useAuth, LoginPage } from '~/features/auth'\n\n// ❌ 錯誤：直接導入內部檔案\nimport { useAuth } from '~/features/auth/composables/useAuth'\n```\n\n**Feature 內部導入**:\n```typescript\n// app/features/auth/store/auth.store.ts\n\n// ✅ 正確：相對路徑導入同 feature 內部模組\nimport type { LoginCredentials } from '../types/auth.types'\nimport { authApi } from '../api/auth.api'\n\n// ❌ 錯誤：透過 barrel exports 導入自己\nimport { authApi } from '~/features/auth'\n```\n\n#### Shared 模組導入規則\n\n```typescript\n// ✅ 正確：直接導入 shared 模組\nimport { Button } from '~/shared/components/Button.vue'\nimport { formatDate } from '~/shared/utils/date-utils'\n\n// ✅ 也可以：如果有 barrel exports\nimport { Button } from '~/shared/components'\n```\n\n### Type Imports\n\n使用 `type` 關鍵字標註純型別導入（優化建置）：\n\n```typescript\n// ✅ 推薦：純型別導入\nimport type { User, ApiResponse } from '~/shared/types'\n\n// ⚠️ 可行但不推薦：混合導入\nimport { type User, fetchUser } from '~/features/users'\n\n// ✅ 正確：分離型別與值導入\nimport type { User } from '~/features/users'\nimport { fetchUser } from '~/features/users'\n```\n\n## Code Structure Patterns\n\n### Vue 單檔元件結構\n\n**標準順序**:\n```vue\n<!-- 1. Script 區塊（優先） -->\n<script setup lang=\"ts\">\n// 1.1 Imports\nimport { ref, computed } from 'vue'\nimport type { User } from '~/shared/types'\n\n// 1.2 Props 定義\ninterface Props {\n  user: User\n  isActive?: boolean\n}\nconst props = withDefaults(defineProps<Props>(), {\n  isActive: true\n})\n\n// 1.3 Emits 定義\nconst emit = defineEmits<{\n  save: [user: User]\n  cancel: []\n}>()\n\n// 1.4 Composables\nconst { data, loading } = useFetch('/api/users')\n\n// 1.5 Reactive State\nconst count = ref(0)\n\n// 1.6 Computed Properties\nconst doubleCount = computed(() => count.value * 2)\n\n// 1.7 Methods\nfunction handleSave() {\n  emit('save', props.user)\n}\n\n// 1.8 Lifecycle Hooks\nonMounted(() => {\n  // initialization\n})\n</script>\n\n<!-- 2. Template 區塊 -->\n<template>\n  <div class=\"container\">\n    <!-- UI 結構 -->\n  </div>\n</template>\n\n<!-- 3. Style 區塊（選用） -->\n<style scoped>\n/* Component-specific styles */\n</style>\n```\n\n### TypeScript 檔案結構\n\n#### Composable 檔案結構\n\n```typescript\n// app/features/auth/composables/useAuth.ts\n\n// 1. Imports\nimport { ref, computed } from 'vue'\nimport type { User, LoginCredentials } from '../types/auth.types'\nimport { authApi } from '../api/auth.api'\n\n// 2. Type Definitions (Local)\ninterface AuthState {\n  user: User | null\n  token: string | null\n}\n\n// 3. Constants (Local)\nconst TOKEN_KEY = 'auth_token'\n\n// 4. Main Export Function\nexport function useAuth() {\n  // 4.1 State\n  const state = ref<AuthState>({\n    user: null,\n    token: null\n  })\n\n  // 4.2 Computed\n  const isAuthenticated = computed(() => !!state.value.user)\n\n  // 4.3 Methods\n  async function login(credentials: LoginCredentials) {\n    const response = await authApi.login(credentials)\n    state.value.user = response.user\n    state.value.token = response.token\n  }\n\n  async function logout() {\n    await authApi.logout()\n    state.value.user = null\n    state.value.token = null\n  }\n\n  // 4.4 Return Public API\n  return {\n    // State\n    user: computed(() => state.value.user),\n    isAuthenticated,\n    // Methods\n    login,\n    logout\n  }\n}\n\n// 5. Helper Functions (Private, at bottom)\nfunction saveToken(token: string) {\n  localStorage.setItem(TOKEN_KEY, token)\n}\n```\n\n#### Store 檔案結構\n\n```typescript\n// app/features/auth/store/auth.store.ts\n\n// 1. Imports\nimport { defineStore } from 'pinia'\nimport { ref, computed } from 'vue'\nimport type { User } from '../types/auth.types'\n\n// 2. Store Definition\nexport const useAuthStore = defineStore('auth', () => {\n  // 2.1 State\n  const user = ref<User | null>(null)\n  const token = ref<string | null>(null)\n\n  // 2.2 Getters (Computed)\n  const isAuthenticated = computed(() => !!user.value)\n  const userName = computed(() => user.value?.name ?? 'Guest')\n\n  // 2.3 Actions\n  function setUser(newUser: User) {\n    user.value = newUser\n  }\n\n  function setToken(newToken: string) {\n    token.value = newToken\n  }\n\n  function logout() {\n    user.value = null\n    token.value = null\n  }\n\n  // 2.4 Return\n  return {\n    // State\n    user,\n    token,\n    // Getters\n    isAuthenticated,\n    userName,\n    // Actions\n    setUser,\n    setToken,\n    logout\n  }\n})\n```\n\n#### API 模組結構\n\n```typescript\n// app/features/auth/api/auth.api.ts\n\n// 1. Imports\nimport type { LoginCredentials, AuthResponse } from '../types/auth.types'\n\n// 2. API Client (if needed)\nconst API_BASE = '/api/auth'\n\n// 3. API Object Export\nexport const authApi = {\n  // 3.1 Login\n  async login(credentials: LoginCredentials): Promise<AuthResponse> {\n    const response = await $fetch(`${API_BASE}/login`, {\n      method: 'POST',\n      body: credentials\n    })\n    return response\n  },\n\n  // 3.2 Logout\n  async logout(): Promise<void> {\n    await $fetch(`${API_BASE}/logout`, {\n      method: 'POST'\n    })\n  },\n\n  // 3.3 Refresh Token\n  async refreshToken(): Promise<AuthResponse> {\n    const response = await $fetch(`${API_BASE}/refresh`, {\n      method: 'POST'\n    })\n    return response\n  }\n}\n\n// 4. Helper Functions (Private)\nfunction handleAuthError(error: unknown) {\n  console.error('Auth error:', error)\n  throw error\n}\n```\n\n### Function/Method Organization\n\n**原則**:\n1. **Input Validation First**: 參數驗證置於函式開頭\n2. **Core Logic in Middle**: 核心邏輯在中間\n3. **Error Handling Throughout**: 適當的錯誤處理\n4. **Clear Return Points**: 清晰的返回點\n\n**範例**:\n```typescript\nasync function updateUser(userId: string, data: Partial<User>): Promise<User> {\n  // 1. Input Validation\n  if (!userId) {\n    throw new Error('User ID is required')\n  }\n\n  if (!data || Object.keys(data).length === 0) {\n    throw new Error('Update data is required')\n  }\n\n  // 2. Core Logic\n  try {\n    const response = await $fetch(`/api/users/${userId}`, {\n      method: 'PATCH',\n      body: data\n    })\n\n    // 3. Return\n    return response\n  } catch (error) {\n    // 4. Error Handling\n    console.error('Failed to update user:', error)\n    throw new Error('Failed to update user')\n  }\n}\n```\n\n## Code Organization Principles\n\n### 1. Single Responsibility Principle (SRP)\n\n**每個檔案應只有一個明確的職責**\n\n✅ **良好範例**:\n```\napp/features/auth/\n├── composables/\n│   └── useAuth.ts          # 只處理認證邏輯\n├── store/\n│   └── auth.store.ts       # 只管理認證狀態\n└── api/\n    └── auth.api.ts         # 只處理認證 API 呼叫\n```\n\n❌ **不良範例**:\n```\napp/features/auth/\n└── auth-everything.ts      # 混雜所有認證相關代碼\n```\n\n### 2. Modularity (模組化)\n\n**代碼應組織成可重用的模組**\n\n- Feature 模組之間互不依賴（高內聚、低耦合）\n- Shared 模組提供通用功能\n- 透過 barrel exports 暴露 public API\n\n### 3. Testability (可測試性)\n\n**結構應便於測試**\n\n- 純函式放在 `utils/`\n- 業務邏輯在 `composables/`（可獨立測試）\n- UI 元件與邏輯分離\n- API 層可 mock\n\n**測試檔案放置**:\n```\napp/features/auth/\n├── composables/\n│   └── useAuth.ts\n└── __tests__/\n    └── useAuth.test.ts     # 測試檔案就近放置\n```\n\n### 4. Consistency (一致性)\n\n**遵循專案既有模式**\n\n- 所有 feature 使用相同結構\n- 命名規範統一\n- Import 順序一致\n- 檔案組織模式一致\n\n## Module Boundaries\n\n### Feature 模組邊界\n\n**規則**:\n\n1. **Feature 之間不可直接依賴**\n   ```typescript\n   // ❌ 錯誤：auth feature 直接依賴 members feature\n   import { useMemberData } from '~/features/members'\n\n   // ✅ 正確：透過 shared 層或事件通訊\n   import { useEventBus } from '~/shared/composables'\n   ```\n\n2. **Feature 可依賴 Shared 模組**\n   ```typescript\n   // ✅ 正確：feature 使用 shared 元件\n   import { Button } from '~/shared/components'\n   ```\n\n3. **Shared 不可依賴 Feature**\n   ```typescript\n   // ❌ 錯誤：shared 依賴 feature\n   // app/shared/composables/useCommon.ts\n   import { useAuth } from '~/features/auth'\n   ```\n\n### 依賴方向圖\n\n```\n┌─────────────────────────────────────┐\n│          Nuxt Pages Layer           │\n│        (app/pages/*.vue)            │\n└────────────┬────────────────────────┘\n             │\n             ↓\n┌─────────────────────────────────────┐\n│         Features Layer              │\n│    (app/features/*/index.ts)        │\n└────────────┬────────────────────────┘\n             │\n             ↓\n┌─────────────────────────────────────┐\n│          Shared Layer               │\n│      (app/shared/**/*)              │\n└────────────┬────────────────────────┘\n             │\n             ↓\n┌─────────────────────────────────────┐\n│      External Dependencies          │\n│     (Vue, Nuxt, Pinia, etc.)        │\n└─────────────────────────────────────┘\n```\n\n**原則**: 依賴只能向下，不可向上或橫向。\n\n### Public API vs Internal\n\n#### Feature Public API (透過 index.ts)\n\n```typescript\n// app/features/auth/index.ts\n\n// ✅ Public API - 外部可用\nexport { useAuth } from './composables/useAuth'\nexport { useAuthStore } from './store/auth.store'\nexport { LoginPage } from './pages/LoginPage.vue'\n\n// ❌ Internal - 不匯出，外部不可用\n// composables/helpers.ts\n// api/auth.api.ts (內部使用)\n```\n\n**使用方式**:\n```typescript\n// 外部只能透過 public API 導入\nimport { useAuth, LoginPage } from '~/features/auth'\n\n// 不能直接導入內部實作\n// import { authApi } from '~/features/auth/api/auth.api' // ❌\n```\n\n### 跨 Feature 通訊\n\n當 features 需要互動時：\n\n1. **透過 Shared Composables**:\n   ```typescript\n   // app/shared/composables/useEventBus.ts\n   export function useEventBus() {\n     const eventBus = useNuxtApp().$eventBus\n     return eventBus\n   }\n\n   // Feature A 發送事件\n   const { emit } = useEventBus()\n   emit('user:login', user)\n\n   // Feature B 監聽事件\n   const { on } = useEventBus()\n   on('user:login', handleUserLogin)\n   ```\n\n2. **透過 Global Store**:\n   ```typescript\n   // app/stores/global.store.ts\n   export const useGlobalStore = defineStore('global', () => {\n     const currentUser = ref<User | null>(null)\n     return { currentUser }\n   })\n\n   // Features 透過 global store 共享狀態\n   ```\n\n3. **透過 Props/Emits**（UI 層）:\n   ```vue\n   <!-- Parent 傳遞資料 -->\n   <FeatureA @data-changed=\"handleDataChange\" />\n   <FeatureB :shared-data=\"sharedData\" />\n   ```\n\n## Code Size Guidelines\n\n### 檔案大小限制\n\n| 檔案類型 | 建議上限 | 超過時處理 |\n|---------|---------|-----------|\n| **Vue Component** | 300 行 | 拆分為多個子元件 |\n| **Composable** | 200 行 | 拆分為多個 composables |\n| **Store** | 300 行 | 考慮分割成多個 stores |\n| **API Module** | 200 行 | 按功能拆分（auth.api.ts → login.api.ts, register.api.ts） |\n| **Utils** | 150 行 | 拆分為多個工具檔案 |\n\n### 函式大小限制\n\n- **Function/Method**: ≤ 50 行\n  - 超過時拆分為多個小函式\n  - 提取 helper functions\n\n- **Nesting Depth**: ≤ 3 層\n  - 使用 early return 減少巢狀\n  - 提取條件邏輯為函式\n\n**範例**:\n```typescript\n// ❌ 不良：巢狀過深\nfunction processUser(user: User) {\n  if (user) {\n    if (user.isActive) {\n      if (user.role === 'admin') {\n        // ... 深層邏輯\n      }\n    }\n  }\n}\n\n// ✅ 良好：使用 early return\nfunction processUser(user: User) {\n  if (!user) return\n  if (!user.isActive) return\n  if (user.role !== 'admin') return\n\n  // ... 核心邏輯\n}\n```\n\n### 元件複雜度\n\n- **Props**: ≤ 10 個\n  - 超過考慮使用物件 prop 或拆分元件\n\n- **Emits**: ≤ 5 個\n  - 超過考慮使用 event bus 或重新設計元件\n\n- **Computed**: ≤ 10 個\n  - 超過考慮移至 composable\n\n## Documentation Standards\n\n### 程式碼文檔規範\n\n#### 1. Public API 必須有文檔\n\n**Composables**:\n```typescript\n/**\n * Authentication composable\n *\n * @description Provides authentication state and methods\n * @returns Authentication state and methods\n *\n * @example\n * ```ts\n * const { user, login, logout } = useAuth()\n * await login({ email, password })\n * ```\n */\nexport function useAuth() {\n  // ...\n}\n```\n\n**Components**:\n```vue\n<script setup lang=\"ts\">\n/**\n * Login Form Component\n *\n * @description A form component for user authentication\n *\n * @props\n * - initialEmail: string - Pre-filled email (optional)\n *\n * @emits\n * - submit: { email: string, password: string } - Emitted on form submission\n * - cancel: void - Emitted when user cancels\n *\n * @example\n * ```vue\n * <LoginForm\n *   initial-email=\"user@example.com\"\n *   @submit=\"handleLogin\"\n * />\n * ```\n */\n</script>\n```\n\n**API Functions**:\n```typescript\n/**\n * Login user with credentials\n *\n * @param credentials - User login credentials\n * @param credentials.email - User email\n * @param credentials.password - User password\n * @returns Authentication response with user data and token\n * @throws {Error} When credentials are invalid\n *\n * @example\n * ```ts\n * const response = await authApi.login({\n *   email: 'user@example.com',\n *   password: 'password123'\n * })\n * ```\n */\nasync login(credentials: LoginCredentials): Promise<AuthResponse> {\n  // ...\n}\n```\n\n#### 2. 複雜邏輯需要內聯註解\n\n```typescript\n// ✅ 良好：解釋複雜邏輯\nfunction calculateDiscount(user: User, amount: number): number {\n  // VIP 用戶享有額外 10% 折扣\n  const vipBonus = user.isVIP ? 0.1 : 0\n\n  // 累積消費達到門檻時，每 1000 元增加 1% 折扣（上限 20%）\n  const loyaltyBonus = Math.min(\n    Math.floor(user.totalSpent / 1000) * 0.01,\n    0.2\n  )\n\n  return amount * (1 - vipBonus - loyaltyBonus)\n}\n```\n\n#### 3. Module README\n\n每個主要 feature 應包含 README.md：\n\n```markdown\n# Auth Feature\n\n## Overview\n用戶認證功能模組，包含登入、登出、註冊等功能。\n\n## Public API\n- `useAuth()` - 認證 composable\n- `useAuthStore()` - 認證狀態管理\n- `LoginPage` - 登入頁面元件\n- `RegisterPage` - 註冊頁面元件\n\n## Usage Example\n\\`\\`\\`typescript\nimport { useAuth } from '~/features/auth'\n\nconst { user, login, logout } = useAuth()\n\nawait login({ email: 'user@example.com', password: 'xxx' })\n\\`\\`\\`\n\n## Dependencies\n- Pinia: 狀態管理\n- VueUse: 工具函式\n\n## Testing\n\\`\\`\\`bash\nvitest run __tests__\n\\`\\`\\`\n```\n\n### JSDoc 標籤使用\n\n| 標籤 | 用途 | 範例 |\n|-----|------|-----|\n| `@description` | 功能描述 | `@description Handles user login` |\n| `@param` | 參數說明 | `@param {string} email - User email` |\n| `@returns` | 返回值說明 | `@returns {User} Authenticated user` |\n| `@throws` | 異常說明 | `@throws {Error} When auth fails` |\n| `@example` | 使用範例 | `@example const user = await login()` |\n| `@deprecated` | 已棄用 | `@deprecated Use loginV2 instead` |\n| `@see` | 相關連結 | `@see https://docs.example.com/auth` |\n\n### 文檔生成\n\n*建議整合*:\n- **TypeDoc**: 自動生成 API 文檔\n- **Storybook**: 元件互動式文檔\n- **VitePress**: 完整專案文檔網站\n\n## Figma 轉代碼工作流程整合\n\n### 元件放置規則\n\n從 Figma 匯出的元件應根據用途放置：\n\n#### 1. 通用 UI 元件 → Shared Components\n\n**適用情況**:\n- 設計系統基礎元件（Button、Input、Card）\n- 可跨多個 features 重用\n- 無業務邏輯\n\n**放置位置**: `app/shared/components/`\n\n**範例**:\n```\napp/shared/components/\n├── Button.vue          # 從 Figma Button component 匯出\n├── Input.vue           # 從 Figma Input component 匯出\n└── Card.vue            # 從 Figma Card component 匯出\n```\n\n#### 2. Feature 專屬元件 → Feature Components\n\n**適用情況**:\n- 特定功能的 UI 元件\n- 包含業務邏輯\n- 只在該 feature 使用\n\n**放置位置**: `app/features/[feature-name]/components/`\n\n**範例**:\n```\napp/features/auth/components/\n├── LoginForm.vue       # 從 Figma Login Form 匯出\n└── RegisterForm.vue    # 從 Figma Register Form 匯出\n```\n\n#### 3. 完整頁面 → Feature Pages\n\n**適用情況**:\n- 完整的頁面設計\n- 包含多個元件組合\n\n**放置位置**: `app/features/[feature-name]/pages/`\n\n**範例**:\n```\napp/features/auth/pages/\n└── LoginPage.vue       # 從 Figma Login Page 匯出\n```\n\n### Figma MCP 工作流程\n\n```mermaid\ngraph LR\n    A[Figma 設計稿] --> B[Figma MCP 匯出]\n    B --> C{元件類型?}\n    C -->|通用元件| D[app/shared/components/]\n    C -->|Feature 元件| E[app/features/*/components/]\n    C -->|完整頁面| F[app/features/*/pages/]\n    D --> G[Playwright MCP 測試]\n    E --> G\n    F --> G\n    G --> H[視覺回歸測試]\n    H --> I[部署]\n```\n\n### 設計系統對齊\n\n**Tailwind CSS 配置**（`tailwind.config.ts`）應與 Figma 設計系統一致：\n\n```typescript\n// tailwind.config.ts\nexport default {\n  theme: {\n    extend: {\n      // 對齊 Figma Design Tokens\n      fontFamily: {\n        sans: ['DM Sans', 'sans-serif'],    // Figma Primary Font\n        serif: ['DM Serif Display', 'serif'], // Figma Heading Font\n      },\n      colors: {\n        // 從 Figma Color Styles 匯出\n        teal: {\n          600: '#0d9488',\n          700: '#0f766e',\n        },\n      },\n    },\n  },\n}\n```\n\n### 命名一致性\n\n**Figma Component 名稱 → Vue Component 名稱**:\n\n| Figma | Vue 檔案 | 元件名稱 |\n|-------|---------|---------|\n| `Button/Primary` | `ButtonPrimary.vue` | `<ButtonPrimary>` |\n| `Input/Text` | `InputText.vue` | `<InputText>` |\n| `Card/Product` | `CardProduct.vue` | `<CardProduct>` |\n| `Auth/LoginForm` | `features/auth/components/LoginForm.vue` | `<LoginForm>` |\n\n**原則**:\n- 保持 Figma 與代碼命名一致\n- 使用 PascalCase\n- 反映元件層級與變體\n\n---\n\n## 總結\n\n本專案採用 **Feature-based 架構**，核心原則：\n\n1. ✅ **功能模組化**: 依 feature 組織代碼，每個 feature 自包含\n2. ✅ **關注點分離**: UI、邏輯、狀態、API 清晰分離\n3. ✅ **高內聚低耦合**: Feature 之間不直接依賴，透過 Shared 層或事件通訊\n4. ✅ **一致性**: 統一的命名規範、檔案結構、Import 順序\n5. ✅ **可維護性**: 清晰的模組邊界、完善的文檔、合理的檔案大小\n6. ✅ **Figma 友善**: 元件放置規則對齊 Figma 工作流程\n\n遵循這些結構原則，確保專案長期可維護、易擴展、團隊協作順暢。\n",
  "fileStats": {
    "size": 31272,
    "lines": 1167,
    "lastModified": "2025-11-10T05:42:06.149Z"
  },
  "comments": []
}