{
  "id": "snapshot_1762754513878_ivz5dfbgr",
  "approvalId": "approval_1762754513875_wius543ek",
  "approvalTitle": "Design - Figma to Vue Component Architecture & Testing",
  "version": 1,
  "timestamp": "2025-11-10T06:01:53.878Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Design Document\n\n## Overview\n\n本設計文檔詳細說明如何將 Figma「預約資料頁/候補/PC」設計稿（Frame ID: 5006:11441）轉換為符合專案架構的 Vue 元件，並透過 Playwright MCP 進行視覺回歸測試。\n\n### 設計稿資訊\n- **Frame Name**: 預約資料頁/候補/PC\n- **Frame ID**: 5006:11441\n- **尺寸**: 1920 x 2147 px (PC Desktop)\n- **主要區塊**:\n  - Header (麵包屑 + 導航列) - 80px 高\n  - Content Container - 2067px 高\n    - Left: 預約表單區 (949px 寬)\n    - Right: 預約詳情卡片 (459px 寬)\n\n### 技術堆疊轉換\nFigma MCP 產生的是 **React + Tailwind CSS** 代碼，需轉換為專案使用的 **Vue 3 + Nuxt 4 + Tailwind CSS v4**。\n\n**轉換要點**:\n1. React 語法 → Vue 3 Composition API (`<script setup>`)\n2. className → class\n3. React hooks → Vue composables\n4. Props/Events → Vue defineProps/defineEmits\n5. 保留所有 Tailwind classes（已支援 v4）\n6. 保留 data-node-id 屬性（用於測試定位）\n\n## Steering Document Alignment\n\n### Technical Standards (tech.md)\n\n#### 遵循的技術標準\n\n1. **Feature-based 架構**\n   - 建立 `app/features/restaurant-booking/` 模組\n   - 包含 pages、components、composables、types\n\n2. **Tailwind CSS v4 整合**\n   - 使用 `@tailwindcss/postcss` (專案已配置)\n   - CSS variables 對應 Figma Design Tokens\n   - 深色模式支援（class-based）\n\n3. **TypeScript 型別安全**\n   - 所有元件使用 TypeScript\n   - Props/Emits 型別定義\n   - 表單資料型別定義\n\n4. **Nuxt 自動導入**\n   - Shared components 自動註冊\n   - Composables 自動導入\n   - Feature 元件透過 barrel exports 匯出\n\n#### Figma Design Tokens 提取\n\n從 Figma 代碼中提取的設計 tokens：\n\n**Colors** (CSS Variables):\n```css\n--primary-darker: #001d5a         /* Header 背景 */\n--primary-on-primary: #ffffff     /* Header 文字 */\n--primary-primary: #2877ee        /* 主色調（按鈕、連結、邊框） */\n--secondary-secondary: #6a6f7b    /* 次要文字 */\n--secondary-on-secondary: #ffffff /* 次要文字（深色背景） */\n--secondary-secondary-container: #b5c7e4  /* 選中狀態底色 */\n--tertiary-tertiary-container: #fff2c2    /* 警告背景 */\n--tertiary-on-tertiary-container: #2d2000 /* 警告文字 */\n--background: #f4f7fe             /* 頁面背景 */\n--surface: #ffffff                /* 卡片背景 */\n--on-surface: #0f172a             /* 主要文字 */\n--on-surface-variant: #3c4a5b     /* 次要資訊文字 */\n--outline-variant: #d7dae0        /* 邊框、分隔線 */\n--outline: #7f8996                /* 禁用狀態文字 */\n--error: #f4493e                  /* 錯誤、必填標示 */\n--disable: rgba(98,91,113,0.16)   /* 禁用背景 */\n```\n\n**Typography**:\n```\n- Font Family: 'Noto Sans CJK TC' (繁體中文)\n- Font Weights: Regular (400), Medium (500), Bold (700)\n- Font Sizes:\n  - 24px: 標題 (h2)\n  - 16px: 內文、表單 label\n  - 14px: 小型提示文字\n- Line Heights: 1.5 (24px), normal (16px)\n```\n\n**Spacing**:\n```\n- Gap: 4px, 8px, 16px, 24px, 32px\n- Padding: 8px, 16px, 24px\n- Border Radius: 4px (checkbox), 6px, 8px, 10px (card)\n- Border Width: 1px, 2px\n```\n\n**需更新至 `tailwind.config.ts`**:\n```typescript\nexport default {\n  theme: {\n    extend: {\n      colors: {\n        // 新增專案特定顏色\n        'primary-darker': '#001d5a',\n        'primary': '#2877ee',\n        'secondary': '#6a6f7b',\n        'error': '#f4493e',\n        // ... 其他顏色\n      },\n      fontFamily: {\n        'noto-sans-tc': ['Noto Sans CJK TC', 'sans-serif'],\n      },\n    },\n  },\n}\n```\n\n### Project Structure (structure.md)\n\n#### 檔案組織規劃\n\n遵循 Feature-based 架構：\n\n```\napp/\n├── features/\n│   └── restaurant-booking/           # 新功能模組\n│       ├── pages/\n│       │   └── ReservationFormPage.vue  # 完整頁面\n│       ├── components/\n│       │   ├── ReservationForm.vue      # 預訂人資料表單\n│       │   ├── SpecialRequestsForm.vue  # 特殊需求表單\n│       │   ├── PaymentMethodSelector.vue # 付款方式選擇器\n│       │   ├── PaymentTermsAgreement.vue # 付款條款同意區塊\n│       │   └── BookingDetailCard.vue     # 預約詳情卡片\n│       ├── composables/\n│       │   ├── useReservationForm.ts     # 表單邏輯\n│       │   └── useFormValidation.ts      # 表單驗證\n│       ├── types/\n│       │   └── reservation.types.ts      # 型別定義\n│       ├── __tests__/\n│       │   ├── visual/                   # 視覺回歸測試\n│       │   │   ├── reservation-form.spec.ts\n│       │   │   └── booking-detail-card.spec.ts\n│       │   └── unit/                     # 單元測試（未來）\n│       └── index.ts                      # Barrel exports\n│\n├── shared/\n│   └── components/\n│       ├── form/                         # 表單元件\n│       │   ├── BaseInput.vue            # 文字輸入框\n│       │   ├── BaseDropdown.vue         # 下拉選單\n│       │   ├── BaseRadioGroup.vue       # 單選按鈕群組\n│       │   ├── BaseCheckbox.vue         # 核取方塊\n│       │   ├── BaseDatePicker.vue       # 日期選擇器\n│       │   ├── BaseTextarea.vue         # 多行文字輸入\n│       │   ├── BaseChip.vue             # 標籤/晶片\n│       │   └── BaseButton.vue           # 按鈕\n│       └── ui/                           # UI 元件\n│           ├── Alert.vue                # 警告提示框\n│           └── Card.vue                 # 卡片容器\n│\n└── pages/\n    └── restaurant/\n        └── reservation-form.vue         # Nuxt 路由頁面\n```\n\n#### 命名規範\n\n遵循 `structure.md` 規範：\n\n| 類型 | 規範 | 範例 |\n|-----|------|------|\n| Vue 元件 | PascalCase | `ReservationForm.vue` |\n| Composables | use + camelCase | `useReservationForm.ts` |\n| Types | PascalCase | `ReservationData` |\n| Props | camelCase | `firstName`, `isRequired` |\n| Events | kebab-case | `@submit`, `@update:model-value` |\n\n## Code Reuse Analysis\n\n### Existing Components to Leverage\n\n專案目前為起始模板，尚無既有元件可重用。本次實作將建立**第一批共用元件**，作為未來專案的基礎。\n\n### 新建元件清單\n\n#### Shared Components (8 個)\n\n1. **BaseInput.vue** - 文字輸入框\n   - 支援 v-model\n   - 必填標示 (`*`)\n   - 錯誤狀態\n   - Placeholder\n\n2. **BaseDropdown.vue** - 下拉選單\n   - 支援 v-model\n   - 選項列表\n   - 鍵盤導航\n\n3. **BaseRadioGroup.vue** - 單選按鈕群組\n   - 支援 v-model\n   - 水平/垂直排列\n\n4. **BaseCheckbox.vue** - 核取方塊\n   - 支援 v-model\n   - Label 文字\n   - 禁用狀態\n\n5. **BaseDatePicker.vue** - 日期選擇器\n   - 支援 v-model (Date)\n   - 日曆彈窗\n   - 最小/最大日期限制\n\n6. **BaseTextarea.vue** - 多行文字輸入\n   - 支援 v-model\n   - 可調整大小\n\n7. **BaseButton.vue** - 按鈕\n   - Variants: primary, secondary, outline, ghost\n   - Sizes: sm, md, lg\n   - Loading 狀態\n   - 禁用狀態\n\n8. **BaseChip.vue** - 標籤/晶片\n   - 可選中狀態\n   - 關閉按鈕（選用）\n\n#### Feature Components (5 個)\n\n1. **ReservationForm.vue** - 預訂人資料表單\n   - 包含：姓、名、稱謂、性別、生日、手機、信箱\n   - 表單驗證\n\n2. **SpecialRequestsForm.vue** - 特殊需求表單\n   - 預訂目的選擇（chips）\n   - 其他備註（textarea）\n\n3. **PaymentMethodSelector.vue** - 付款方式選擇器\n   - 4 種付款方式單選\n   - PayPal 圖示顯示\n\n4. **PaymentTermsAgreement.vue** - 付款條款同意區塊\n   - 條款內容捲動區域\n   - 同意核取方塊\n\n5. **BookingDetailCard.vue** - 預約詳情卡片\n   - 餐廳圖片\n   - 餐廳資訊（名稱、地址、電話）\n   - 預約資訊（日期、時間、人數）\n   - 上一步/登記候補按鈕\n\n### Integration Points\n\n#### Figma MCP 整合\n- **工具**: `get_design_context` - 取得完整設計上下文\n- **工具**: `get_screenshot` - 取得設計稿截圖作為視覺基準\n- **工具**: `get_variable_defs` - 取得 Design Tokens (如有)\n\n#### Playwright MCP 整合\n- **工具**: `browser_snapshot` - 可訪問性快照\n- **工具**: `browser_take_screenshot` - 元件截圖\n- **工具**: `browser_fill_form` - 表單填寫\n- **工具**: `browser_click` - 點擊互動\n- **工具**: `browser_select_option` - 下拉選擇\n\n## Architecture\n\n### 整體架構圖\n\n```mermaid\ngraph TB\n    subgraph \"Nuxt Pages Layer\"\n        A[pages/restaurant/<br/>reservation-form.vue]\n    end\n\n    subgraph \"Feature Layer: restaurant-booking\"\n        B[ReservationFormPage.vue]\n        C[ReservationForm.vue]\n        D[SpecialRequestsForm.vue]\n        E[PaymentMethodSelector.vue]\n        F[PaymentTermsAgreement.vue]\n        G[BookingDetailCard.vue]\n\n        H[useReservationForm<br/>composable]\n        I[useFormValidation<br/>composable]\n    end\n\n    subgraph \"Shared Components Layer\"\n        J[BaseInput]\n        K[BaseDropdown]\n        L[BaseRadioGroup]\n        M[BaseCheckbox]\n        N[BaseDatePicker]\n        O[BaseTextarea]\n        P[BaseButton]\n        Q[BaseChip]\n    end\n\n    A --> B\n    B --> C\n    B --> D\n    B --> E\n    B --> F\n    B --> G\n\n    C --> J\n    C --> K\n    C --> L\n    C --> M\n    C --> N\n\n    D --> Q\n    D --> O\n\n    E --> L\n\n    F --> O\n    F --> M\n\n    G --> P\n\n    C --> H\n    D --> H\n    E --> H\n    F --> H\n\n    H --> I\n\n    style A fill:#e1f5e1\n    style B fill:#fff4e6\n    style J fill:#e3f2fd\n    style K fill:#e3f2fd\n    style L fill:#e3f2fd\n    style M fill:#e3f2fd\n    style N fill:#e3f2fd\n    style O fill:#e3f2fd\n    style P fill:#e3f2fd\n    style Q fill:#e3f2fd\n    style H fill:#f3e5f5\n    style I fill:#f3e5f5\n```\n\n### Modular Design Principles\n\n#### 1. Single File Responsibility\n\n每個元件檔案只負責一個 UI 功能：\n\n- ✅ **BaseInput.vue** - 只處理單一文字輸入框\n- ✅ **ReservationForm.vue** - 只處理預訂人資料表單區塊\n- ✅ **useReservationForm.ts** - 只處理表單狀態管理\n\n#### 2. Component Isolation\n\nShared components 完全獨立，無業務邏輯：\n\n```vue\n<!-- BaseInput.vue - Dumb Component -->\n<script setup lang=\"ts\">\ninterface Props {\n  modelValue: string\n  label?: string\n  placeholder?: string\n  required?: boolean\n  error?: string\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<{\n  'update:modelValue': [value: string]\n}>()\n</script>\n```\n\nFeature components 封裝業務邏輯：\n\n```vue\n<!-- ReservationForm.vue - Smart Component -->\n<script setup lang=\"ts\">\nimport { useReservationForm } from '../composables/useReservationForm'\n\nconst { formData, errors, validate } = useReservationForm()\n</script>\n```\n\n#### 3. Service Layer Separation\n\n- **Presentation (Vue Components)**: 只負責 UI 渲染與事件處理\n- **Business Logic (Composables)**: 封裝表單驗證、狀態管理\n- **Data (Types)**: 型別定義與介面\n\n```typescript\n// types/reservation.types.ts - Data Layer\nexport interface ReservationData {\n  firstName: string\n  lastName: string\n  title: string\n  gender: string\n  birthday: Date | null\n  phoneCountry: string\n  phoneNumber: string\n  email: string\n  saveInfo: boolean\n}\n\n// composables/useReservationForm.ts - Business Logic Layer\nexport function useReservationForm() {\n  const formData = ref<ReservationData>({\n    firstName: '',\n    lastName: '',\n    // ...\n  })\n\n  const validate = () => {\n    // 驗證邏輯\n  }\n\n  return { formData, validate }\n}\n\n// components/ReservationForm.vue - Presentation Layer\n// 使用 composable，只負責渲染\n```\n\n#### 4. Utility Modularity\n\n表單驗證工具模組化：\n\n```typescript\n// composables/useFormValidation.ts\nexport function useFormValidation() {\n  const validateEmail = (email: string) => {\n    const regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n    return regex.test(email)\n  }\n\n  const validatePhone = (phone: string) => {\n    return /^09\\d{8}$/.test(phone)\n  }\n\n  return { validateEmail, validatePhone }\n}\n```\n\n## Components and Interfaces\n\n### Shared Components\n\n#### 1. BaseInput\n\n**Purpose**: 可重用的文字輸入框元件\n\n**Props**:\n```typescript\ninterface Props {\n  modelValue: string                    // v-model 綁定\n  label?: string                         // Label 文字\n  placeholder?: string                   // Placeholder\n  required?: boolean                     // 是否必填\n  error?: string                         // 錯誤訊息\n  type?: 'text' | 'email' | 'tel'       // Input type\n  disabled?: boolean                     // 禁用狀態\n}\n```\n\n**Emits**:\n```typescript\n{\n  'update:modelValue': [value: string]  // v-model 更新\n}\n```\n\n**Reuses**: 無（基礎元件）\n\n**檔案位置**: `app/shared/components/form/BaseInput.vue`\n\n---\n\n#### 2. BaseDropdown\n\n**Purpose**: 可重用的下拉選單元件\n\n**Props**:\n```typescript\ninterface Option {\n  label: string\n  value: string | number\n}\n\ninterface Props {\n  modelValue: string | number | null    // v-model 綁定\n  label?: string                         // Label 文字\n  placeholder?: string                   // 未選擇時顯示文字\n  options: Option[]                      // 選項列表\n  required?: boolean                     // 是否必填\n  error?: string                         // 錯誤訊息\n  disabled?: boolean                     // 禁用狀態\n}\n```\n\n**Emits**:\n```typescript\n{\n  'update:modelValue': [value: string | number | null]\n}\n```\n\n**Reuses**: 無\n\n**檔案位置**: `app/shared/components/form/BaseDropdown.vue`\n\n---\n\n#### 3. BaseRadioGroup\n\n**Purpose**: 可重用的單選按鈕群組\n\n**Props**:\n```typescript\ninterface RadioOption {\n  label: string\n  value: string | number\n}\n\ninterface Props {\n  modelValue: string | number | null    // v-model 綁定\n  options: RadioOption[]                 // 選項列表\n  name: string                           // Radio group name\n  orientation?: 'horizontal' | 'vertical' // 排列方向\n  disabled?: boolean                     // 禁用狀態\n}\n```\n\n**Emits**:\n```typescript\n{\n  'update:modelValue': [value: string | number]\n}\n```\n\n**Reuses**: 無\n\n**檔案位置**: `app/shared/components/form/BaseRadioGroup.vue`\n\n---\n\n#### 4. BaseCheckbox\n\n**Purpose**: 可重用的核取方塊元件\n\n**Props**:\n```typescript\ninterface Props {\n  modelValue: boolean                    // v-model 綁定\n  label?: string                         // Label 文字\n  disabled?: boolean                     // 禁用狀態\n}\n```\n\n**Emits**:\n```typescript\n{\n  'update:modelValue': [value: boolean]\n}\n```\n\n**Reuses**: 無\n\n**檔案位置**: `app/shared/components/form/BaseCheckbox.vue`\n\n---\n\n#### 5. BaseDatePicker\n\n**Purpose**: 可重用的日期選擇器元件\n\n**Props**:\n```typescript\ninterface Props {\n  modelValue: Date | null                // v-model 綁定\n  label?: string                         // Label 文字\n  placeholder?: string                   // Placeholder\n  minDate?: Date                         // 最小日期\n  maxDate?: Date                         // 最大日期\n  disabled?: boolean                     // 禁用狀態\n}\n```\n\n**Emits**:\n```typescript\n{\n  'update:modelValue': [value: Date | null]\n}\n```\n\n**Reuses**: 可考慮整合第三方庫（如 VueDatePicker）或自建\n\n**檔案位置**: `app/shared/components/form/BaseDatePicker.vue`\n\n---\n\n#### 6. BaseTextarea\n\n**Purpose**: 可重用的多行文字輸入元件\n\n**Props**:\n```typescript\ninterface Props {\n  modelValue: string                     // v-model 綁定\n  label?: string                         // Label 文字\n  placeholder?: string                   // Placeholder\n  rows?: number                          // 預設行數\n  maxLength?: number                     // 最大字數\n  resize?: boolean                       // 是否可調整大小\n  disabled?: boolean                     // 禁用狀態\n}\n```\n\n**Emits**:\n```typescript\n{\n  'update:modelValue': [value: string]\n}\n```\n\n**Reuses**: 無\n\n**檔案位置**: `app/shared/components/form/BaseTextarea.vue`\n\n---\n\n#### 7. BaseButton\n\n**Purpose**: 可重用的按鈕元件\n\n**Props**:\n```typescript\ninterface Props {\n  variant?: 'primary' | 'secondary' | 'outline' | 'ghost'  // 樣式變體\n  size?: 'sm' | 'md' | 'lg'             // 尺寸\n  disabled?: boolean                     // 禁用狀態\n  loading?: boolean                      // 載入狀態\n  type?: 'button' | 'submit' | 'reset'  // Button type\n}\n```\n\n**Emits**:\n```typescript\n{\n  'click': []                            // 點擊事件\n}\n```\n\n**Slots**:\n- `default`: 按鈕文字內容\n\n**Reuses**: 無\n\n**檔案位置**: `app/shared/components/form/BaseButton.vue`\n\n---\n\n#### 8. BaseChip\n\n**Purpose**: 可重用的標籤/晶片元件\n\n**Props**:\n```typescript\ninterface Props {\n  label: string                          // 顯示文字\n  selected?: boolean                     // 選中狀態\n  closable?: boolean                     // 是否可關閉\n  disabled?: boolean                     // 禁用狀態\n}\n```\n\n**Emits**:\n```typescript\n{\n  'click': []                            // 點擊事件\n  'close': []                            // 關閉事件\n}\n```\n\n**Reuses**: 無\n\n**檔案位置**: `app/shared/components/form/BaseChip.vue`\n\n---\n\n### Feature Components\n\n#### 1. ReservationForm\n\n**Purpose**: 處理預訂人資料輸入\n\n**Props**: 無（自包含狀態）\n\n**Emits**:\n```typescript\n{\n  'submit': [data: ReservationData]      // 表單提交\n}\n```\n\n**Dependencies**:\n- BaseInput\n- BaseDropdown\n- BaseRadioGroup\n- BaseCheckbox\n- BaseDatePicker\n\n**Reuses**:\n- `useReservationForm` composable - 表單狀態管理\n- `useFormValidation` composable - 驗證邏輯\n\n**Data Structure**:\n```typescript\ninterface ReservationData {\n  firstName: string          // 姓\n  lastName: string           // 名\n  title: string             // 稱謂\n  gender: string            // 性別\n  birthday: Date | null     // 生日\n  phoneCountry: string      // 手機國碼\n  phoneNumber: string       // 手機號碼\n  email: string             // 信箱\n  saveInfo: boolean         // 儲存資訊\n}\n```\n\n**檔案位置**: `app/features/restaurant-booking/components/ReservationForm.vue`\n\n---\n\n#### 2. SpecialRequestsForm\n\n**Purpose**: 處理特殊需求選擇與備註\n\n**Props**: 無\n\n**Emits**:\n```typescript\n{\n  'submit': [data: SpecialRequestsData]\n}\n```\n\n**Dependencies**:\n- BaseChip\n- BaseTextarea\n\n**Reuses**:\n- `useReservationForm` composable\n\n**Data Structure**:\n```typescript\ninterface SpecialRequestsData {\n  purpose: string[]         // 預訂目的（多選）\n  notes: string             // 其他備註\n}\n```\n\n**檔案位置**: `app/features/restaurant-booking/components/SpecialRequestsForm.vue`\n\n---\n\n#### 3. PaymentMethodSelector\n\n**Purpose**: 選擇付款方式\n\n**Props**: 無\n\n**Emits**:\n```typescript\n{\n  'update:modelValue': [value: PaymentMethod]\n}\n```\n\n**Dependencies**:\n- BaseRadioGroup\n- Alert (警告提示框)\n\n**Data Structure**:\n```typescript\ntype PaymentMethod = 'cash' | 'credit_card' | 'bank_transfer' | 'paypal'\n```\n\n**檔案位置**: `app/features/restaurant-booking/components/PaymentMethodSelector.vue`\n\n---\n\n#### 4. PaymentTermsAgreement\n\n**Purpose**: 顯示付款條款並取得同意\n\n**Props**: 無\n\n**Emits**:\n```typescript\n{\n  'agree': [agreed: boolean]\n}\n```\n\n**Dependencies**:\n- BaseCheckbox\n\n**檔案位置**: `app/features/restaurant-booking/components/PaymentTermsAgreement.vue`\n\n---\n\n#### 5. BookingDetailCard\n\n**Purpose**: 顯示預約詳情摘要\n\n**Props**:\n```typescript\ninterface Props {\n  restaurantName: string\n  address: string\n  phone: string\n  date: Date\n  time: string\n  guests: {\n    adults: number\n    children: number\n    infants: number\n    seniors: number\n  }\n  imageUrl?: string\n}\n```\n\n**Emits**:\n```typescript\n{\n  'back': []              // 上一步\n  'submit': []            // 登記候補\n}\n```\n\n**Dependencies**:\n- BaseButton\n- Icon components (calendar, clock, person, location, phone)\n\n**檔案位置**: `app/features/restaurant-booking/components/BookingDetailCard.vue`\n\n---\n\n### Page Component\n\n#### ReservationFormPage\n\n**Purpose**: 整合所有表單元件的完整頁面\n\n**Props**: 無\n\n**Emits**: 無（處理提交邏輯）\n\n**Dependencies**:\n- ReservationForm\n- SpecialRequestsForm\n- PaymentMethodSelector\n- PaymentTermsAgreement\n- BookingDetailCard\n\n**Layout**:\n```\n┌─────────────────────────────────────────────────┐\n│ Header (Breadcrumb + Navigation)                │\n├─────────────────────────────────────────────────┤\n│ Page Title + Alert                              │\n├───────────────────────────┬─────────────────────┤\n│ Left Column (949px)       │ Right Column (459px)│\n│ ┌───────────────────────┐ │ ┌─────────────────┐ │\n│ │ ReservationForm       │ │ │ Booking Detail  │ │\n│ └───────────────────────┘ │ │ Card            │ │\n│ ┌───────────────────────┐ │ │                 │ │\n│ │ SpecialRequestsForm   │ │ │                 │ │\n│ └───────────────────────┘ │ │                 │ │\n│ ┌───────────────────────┐ │ └─────────────────┘ │\n│ │ PaymentMethodSelector │ │                     │\n│ └───────────────────────┘ │                     │\n│ ┌───────────────────────┐ │                     │\n│ │ PaymentTermsAgreement │ │                     │\n│ └───────────────────────┘ │                     │\n│ Checkboxes (3)            │                     │\n└───────────────────────────┴─────────────────────┘\n```\n\n**檔案位置**: `app/features/restaurant-booking/pages/ReservationFormPage.vue`\n\n## Data Models\n\n### ReservationData\n\n完整的預約表單資料模型：\n\n```typescript\n// app/features/restaurant-booking/types/reservation.types.ts\n\nexport interface ReservationData {\n  // 預訂人資料\n  firstName: string\n  lastName: string\n  title: string                    // '先生' | '小姐' | '女士' | 其他\n  gender: string                   // '男生' | '女生' | '多元性別' | '保密'\n  birthday: Date | null\n  phoneCountry: string             // '+886'\n  phoneNumber: string              // '0912345678'\n  email: string\n  saveInfo: boolean\n\n  // 特殊需求\n  purpose: string[]                // ['生日', '結婚週年', ...]\n  notes: string\n\n  // 付款方式\n  paymentMethod: PaymentMethod\n\n  // 同意事項\n  agreePaymentTerms: boolean\n  agreePrivacyPolicy: boolean\n  agreeReservationPolicy: boolean\n  agreeWaitlistPolicy: boolean\n}\n\nexport type PaymentMethod = 'cash' | 'credit_card' | 'bank_transfer' | 'paypal'\n\nexport interface ValidationErrors {\n  firstName?: string\n  lastName?: string\n  title?: string\n  birthday?: string\n  phoneNumber?: string\n  email?: string\n  paymentMethod?: string\n  agreePaymentTerms?: string\n  agreePrivacyPolicy?: string\n  agreeReservationPolicy?: string\n  agreeWaitlistPolicy?: string\n}\n```\n\n### BookingInfo\n\n預約詳情資料模型：\n\n```typescript\nexport interface BookingInfo {\n  restaurant: {\n    name: string\n    address: string\n    phone: string\n    imageUrl?: string\n  }\n  booking: {\n    date: Date\n    time: string                   // '18:00'\n    guests: {\n      adults: number\n      children: number\n      infants: number\n      seniors: number\n    }\n  }\n}\n```\n\n## Error Handling\n\n### Error Scenarios\n\n#### 1. 表單驗證錯誤\n\n**Scenario**: 使用者提交表單時，必填欄位為空或格式不正確\n\n**Handling**:\n```typescript\nconst validate = () => {\n  const errors: ValidationErrors = {}\n\n  if (!formData.value.firstName.trim()) {\n    errors.firstName = '請輸入姓氏'\n  }\n\n  if (!formData.value.email.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/)) {\n    errors.email = '信箱格式不正確'\n  }\n\n  if (!formData.value.agreePaymentTerms) {\n    errors.agreePaymentTerms = '請同意付款規範'\n  }\n\n  return errors\n}\n```\n\n**User Impact**:\n- 錯誤訊息顯示在對應欄位下方（紅色文字）\n- 輸入框邊框變為紅色\n- 頁面不跳轉，focus 到第一個錯誤欄位\n\n#### 2. 網路請求失敗\n\n**Scenario**: API 請求失敗（未來實作）\n\n**Handling**:\n```typescript\ntry {\n  await submitReservation(formData.value)\n} catch (error) {\n  // 顯示全域錯誤提示\n  showError('提交失敗，請稍後再試')\n}\n```\n\n**User Impact**:\n- 顯示錯誤 toast 通知\n- 保留表單資料，不清空\n- 提供重試按鈕\n\n#### 3. 瀏覽器不支援\n\n**Scenario**: 使用者使用過舊的瀏覽器\n\n**Handling**:\n- 使用 `@nuxtjs/device` 偵測瀏覽器\n- 顯示升級提示\n\n**User Impact**:\n- 顯示警告橫幅：「建議使用 Chrome 90+ 以獲得最佳體驗」\n\n#### 4. LocalStorage 失敗\n\n**Scenario**: 使用者選擇「儲存資訊」但 LocalStorage 不可用\n\n**Handling**:\n```typescript\nconst saveToLocalStorage = (data: ReservationData) => {\n  try {\n    localStorage.setItem('reservation_info', JSON.stringify(data))\n  } catch (error) {\n    console.warn('無法儲存資訊', error)\n    // 靜默失敗，不影響主要流程\n  }\n}\n```\n\n**User Impact**:\n- 功能靜默失敗\n- 不影響表單提交\n\n## Testing Strategy\n\n### Unit Testing (未來實作)\n\n**工具**: Vitest + @vue/test-utils\n\n**測試範圍**:\n- Composables 邏輯測試\n- 表單驗證函式測試\n\n**範例**:\n```typescript\n// __tests__/unit/useFormValidation.test.ts\nimport { describe, it, expect } from 'vitest'\nimport { useFormValidation } from '../composables/useFormValidation'\n\ndescribe('useFormValidation', () => {\n  it('should validate email correctly', () => {\n    const { validateEmail } = useFormValidation()\n    expect(validateEmail('test@example.com')).toBe(true)\n    expect(validateEmail('invalid')).toBe(false)\n  })\n})\n```\n\n### Integration Testing (未來實作)\n\n**工具**: Playwright (非 MCP，純 E2E)\n\n**測試流程**:\n1. 填寫完整表單\n2. 驗證提交成功\n3. 驗證資料傳遞正確\n\n### Visual Regression Testing (本次重點)\n\n**工具**: Playwright MCP\n\n**測試策略**:\n\n#### 1. Component-level Tests\n\n測試每個 Shared Component 的視覺呈現：\n\n**檔案**: `app/shared/components/form/__tests__/visual/BaseInput.spec.ts`\n\n```typescript\nimport { test, expect } from '@playwright/test'\n\ntest.describe('BaseInput Visual Tests', () => {\n  test('default state', async ({ page }) => {\n    await page.goto('/test/base-input?state=default')\n\n    // 使用 Playwright MCP browser_take_screenshot\n    await page.screenshot({\n      path: 'screenshots/BaseInput-default.png'\n    })\n\n    // 比對基準截圖\n    await expect(page).toHaveScreenshot('BaseInput-default.png')\n  })\n\n  test('focus state', async ({ page }) => {\n    await page.goto('/test/base-input')\n    await page.locator('input').focus()\n    await expect(page).toHaveScreenshot('BaseInput-focus.png')\n  })\n\n  test('error state', async ({ page }) => {\n    await page.goto('/test/base-input?state=error')\n    await expect(page).toHaveScreenshot('BaseInput-error.png')\n  })\n\n  test('disabled state', async ({ page }) => {\n    await page.goto('/test/base-input?state=disabled')\n    await expect(page).toHaveScreenshot('BaseInput-disabled.png')\n  })\n})\n```\n\n**測試狀態清單**:\n\n| Component | States to Test |\n|-----------|----------------|\n| BaseInput | default, focus, filled, error, disabled |\n| BaseDropdown | closed, open, selected, disabled |\n| BaseCheckbox | unchecked, checked, disabled |\n| BaseDatePicker | closed, calendar-open, date-selected |\n| BaseButton | default, hover, active, disabled, loading |\n| BaseChip | unselected, selected, disabled |\n\n#### 2. Page-level Tests\n\n測試完整頁面：\n\n**檔案**: `app/features/restaurant-booking/__tests__/visual/ReservationFormPage.spec.ts`\n\n```typescript\nimport { test, expect } from '@playwright/test'\n\ntest.describe('ReservationFormPage Visual Tests', () => {\n  test('empty form', async ({ page }) => {\n    await page.goto('/restaurant/reservation-form')\n\n    // Full page screenshot\n    await page.screenshot({\n      path: 'screenshots/ReservationFormPage-empty.png',\n      fullPage: true\n    })\n\n    await expect(page).toHaveScreenshot('ReservationFormPage-empty.png', {\n      fullPage: true\n    })\n  })\n\n  test('partially filled form', async ({ page }) => {\n    await page.goto('/restaurant/reservation-form')\n\n    // 使用 Playwright MCP browser_fill_form\n    await page.fill('[name=\"firstName\"]', '王')\n    await page.fill('[name=\"lastName\"]', '小明')\n    await page.selectOption('[name=\"title\"]', '先生')\n\n    await expect(page).toHaveScreenshot('ReservationFormPage-partial.png', {\n      fullPage: true\n    })\n  })\n\n  test('validation errors', async ({ page }) => {\n    await page.goto('/restaurant/reservation-form')\n\n    // 點擊提交按鈕觸發驗證\n    await page.click('button[type=\"submit\"]')\n\n    // 等待錯誤訊息出現\n    await page.waitForSelector('.error-message')\n\n    await expect(page).toHaveScreenshot('ReservationFormPage-errors.png', {\n      fullPage: true\n    })\n  })\n})\n```\n\n#### 3. Interaction Flow Tests\n\n測試互動流程：\n\n```typescript\ntest.describe('Reservation Flow', () => {\n  test('complete reservation flow', async ({ page }) => {\n    await page.goto('/restaurant/reservation-form')\n\n    // Step 1: Fill personal info\n    await page.fill('[name=\"firstName\"]', '王')\n    await page.fill('[name=\"lastName\"]', '小明')\n    await page.selectOption('[name=\"title\"]', '先生')\n    await page.click('[value=\"男生\"]')\n\n    await page.screenshot({ path: 'flow-1-personal.png' })\n\n    // Step 2: Select special requests\n    await page.click('text=生日')\n    await page.fill('textarea[name=\"notes\"]', '需要兒童椅')\n\n    await page.screenshot({ path: 'flow-2-requests.png' })\n\n    // Step 3: Choose payment method\n    await page.click('[value=\"credit_card\"]')\n\n    await page.screenshot({ path: 'flow-3-payment.png' })\n\n    // Step 4: Agree to terms\n    await page.check('[name=\"agreePaymentTerms\"]')\n    await page.check('[name=\"agreePrivacyPolicy\"]')\n\n    await page.screenshot({ path: 'flow-4-submit.png', fullPage: true })\n  })\n})\n```\n\n### Accessibility Testing\n\n使用 Playwright MCP `browser_snapshot` 工具：\n\n```typescript\ntest('accessibility snapshot', async ({ page }) => {\n  await page.goto('/restaurant/reservation-form')\n\n  // 使用 Playwright MCP browser_snapshot\n  const snapshot = await page.accessibility.snapshot()\n\n  // 驗證重要的可訪問性屬性\n  expect(snapshot).toMatchObject({\n    role: 'main',\n    children: expect.arrayContaining([\n      expect.objectContaining({\n        role: 'form',\n        name: '預訂人資料'\n      })\n    ])\n  })\n})\n```\n\n### Test Coverage Goals\n\n| Category | Target |\n|----------|--------|\n| Visual Regression | 100% (所有元件狀態) |\n| Unit Tests | 80% (composables, utils) |\n| E2E Tests | 主要流程覆蓋 |\n| Accessibility | WCAG 2.1 AA 合規 |\n\n## Implementation Phases\n\n### Phase 1: Shared Components (優先)\n\n**時程**: 第 1-2 天\n\n1. BaseInput\n2. BaseDropdown\n3. BaseCheckbox\n4. BaseButton\n\n**交付物**:\n- 4 個元件實作\n- 基本視覺測試\n- Storybook 範例（選用）\n\n### Phase 2: Advanced Shared Components\n\n**時程**: 第 3 天\n\n5. BaseRadioGroup\n6. BaseDatePicker\n7. BaseTextarea\n8. BaseChip\n\n**交付物**:\n- 4 個元件實作\n- 完整視覺測試\n\n### Phase 3: Feature Components\n\n**時程**: 第 4-5 天\n\n1. ReservationForm\n2. SpecialRequestsForm\n3. PaymentMethodSelector\n4. PaymentTermsAgreement\n5. BookingDetailCard\n\n**交付物**:\n- 5 個元件實作\n- Composables 實作\n- 元件層級視覺測試\n\n### Phase 4: Page Integration\n\n**時程**: 第 6 天\n\n1. ReservationFormPage\n2. Nuxt 路由設置\n3. 完整頁面整合\n\n**交付物**:\n- 完整頁面實作\n- 頁面層級視覺測試\n- 互動流程測試\n\n### Phase 5: Testing & Documentation\n\n**時程**: 第 7 天\n\n1. 執行所有視覺回歸測試\n2. 修正視覺差異\n3. 撰寫文檔（README、WORKFLOW、TESTING）\n4. 記錄實作日誌（log-implementation）\n\n**交付物**:\n- 100% 測試通過\n- 完整文檔\n- 實作日誌\n\n## Figma to Vue Conversion Examples\n\n### Example 1: BaseInput Component\n\n**Figma 生成的 React 代碼**:\n```tsx\n<div className=\"content-stretch flex flex-col gap-[8px] grow items-start min-h-px min-w-[150px] relative shrink-0\" data-name=\"input\" data-node-id=\"5008:17257\">\n  <div className=\"content-stretch flex font-['Noto_Sans_CJK_TC:Medium',sans-serif] gap-[4px] items-center justify-center leading-[normal] not-italic relative shrink-0 text-[16px] text-nowrap whitespace-pre\" data-name=\"Label\" data-node-id=\"5008:17266\">\n    <p className=\"relative shrink-0 text-[color:var(--secondary\\/secondary,#6a6f7b)]\" data-node-id=\"5008:17267\">姓</p>\n    <p className=\"relative shrink-0 text-[color:var(--error,#f4493e)]\" data-node-id=\"5008:17268\">*</p>\n  </div>\n  <div className=\"content-stretch flex flex-col gap-[4px] items-start relative shrink-0 w-full\" data-name=\"Container\" data-node-id=\"5008:17259\">\n    <div className=\"bg-[var(--surface,#ffffff)] border border-[var(--outline-variant,#d7dae0)] border-solid box-border content-stretch flex gap-[8px] h-[50px] items-center px-[16px] py-0 relative rounded-[8px] shrink-0 w-full\" data-name=\"Container\" data-node-id=\"5008:17260\">\n      <div className=\"basis-0 flex flex-col font-['Noto_Sans_TC:Regular',sans-serif] font-normal grow justify-center leading-[0] min-h-px min-w-px relative shrink-0 text-[16px] text-[color:var(--outline-variant,#d7dae0)]\" data-node-id=\"5008:17261\">\n        <p className=\"leading-[24px]\">請輸入</p>\n      </div>\n    </div>\n  </div>\n</div>\n```\n\n**轉換後的 Vue 代碼**:\n```vue\n<!-- app/shared/components/form/BaseInput.vue -->\n<script setup lang=\"ts\">\ninterface Props {\n  modelValue: string\n  label?: string\n  placeholder?: string\n  required?: boolean\n  error?: string\n  disabled?: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  placeholder: '請輸入',\n  required: false,\n  disabled: false\n})\n\nconst emit = defineEmits<{\n  'update:modelValue': [value: string]\n}>()\n\nconst handleInput = (event: Event) => {\n  const target = event.target as HTMLInputElement\n  emit('update:modelValue', target.value)\n}\n</script>\n\n<template>\n  <div\n    class=\"content-stretch flex flex-col gap-2 grow items-start min-h-px min-w-[150px] relative shrink-0\"\n    data-name=\"input\"\n  >\n    <!-- Label -->\n    <div\n      v-if=\"label\"\n      class=\"content-stretch flex font-['Noto_Sans_CJK_TC'] font-medium gap-1 items-center justify-center leading-normal not-italic relative shrink-0 text-base text-nowrap whitespace-pre\"\n      data-name=\"Label\"\n    >\n      <p class=\"relative shrink-0 text-[var(--secondary-secondary,#6a6f7b)]\">\n        {{ label }}\n      </p>\n      <p\n        v-if=\"required\"\n        class=\"relative shrink-0 text-[var(--error,#f4493e)]\"\n      >\n        *\n      </p>\n    </div>\n\n    <!-- Input Container -->\n    <div\n      class=\"content-stretch flex flex-col gap-1 items-start relative shrink-0 w-full\"\n      data-name=\"Container\"\n    >\n      <input\n        :value=\"modelValue\"\n        :placeholder=\"placeholder\"\n        :disabled=\"disabled\"\n        :class=\"[\n          'bg-[var(--surface,#ffffff)]',\n          'border border-solid box-border',\n          'content-stretch flex gap-2 h-[50px] items-center px-4 py-0',\n          'relative rounded-lg shrink-0 w-full',\n          'font-[\\'Noto_Sans_TC\\'] font-normal text-base leading-6',\n          error\n            ? 'border-[var(--error,#f4493e)]'\n            : 'border-[var(--outline-variant,#d7dae0)]',\n          disabled\n            ? 'bg-gray-100 cursor-not-allowed'\n            : '',\n          'placeholder:text-[var(--outline-variant,#d7dae0)]'\n        ]\"\n        @input=\"handleInput\"\n      />\n\n      <!-- Error Message -->\n      <p\n        v-if=\"error\"\n        class=\"text-sm text-[var(--error,#f4493e)] mt-1\"\n      >\n        {{ error }}\n      </p>\n    </div>\n  </div>\n</template>\n```\n\n**轉換要點**:\n1. ✅ `className` → `class`\n2. ✅ React hooks → Vue `ref`, `computed`\n3. ✅ Props 定義使用 `defineProps<T>()`\n4. ✅ Events 使用 `defineEmits<T>()`\n5. ✅ 保留所有 Tailwind classes\n6. ✅ 保留 `data-name` 屬性（測試定位）\n7. ✅ CSS variables 保持不變\n8. ✅ 條件渲染 `{show && ...}` → `v-if=\"show\"`\n9. ✅ 動態 class `className={...}` → `:class=\"[...]\"`\n\n### Example 2: BaseCheckbox Component\n\n**Figma React 代碼**:\n```tsx\nfunction Checkbox({ className, property1 = \"checked\", device = \"PC\" }: CheckboxProps) {\n  if (property1 === \"Default\" && device === \"PC\") {\n    return <div className={className} data-name=\"Property 1=Default, device=PC\" data-node-id=\"795:19080\" />;\n  }\n  return (\n    <div className={className} data-name=\"Property 1=checked, device=PC\" data-node-id=\"795:19081\">\n      <div className=\"content-stretch flex items-center justify-center overflow-clip relative rounded-[inherit] size-[16px]\">\n        <div className=\"box-border content-stretch flex flex-col gap-[10px] items-center justify-center px-[3px] py-[4px] relative shrink-0 size-[16px]\" data-name=\"icon/16/check\">\n          <div className=\"h-[6.633px] relative shrink-0 w-[9px]\">\n            <img alt=\"\" className=\"block max-w-none size-full\" src={img} />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n```\n\n**Vue 轉換**:\n```vue\n<!-- app/shared/components/form/BaseCheckbox.vue -->\n<script setup lang=\"ts\">\ninterface Props {\n  modelValue: boolean\n  label?: string\n  disabled?: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  modelValue: false,\n  disabled: false\n})\n\nconst emit = defineEmits<{\n  'update:modelValue': [value: boolean]\n}>()\n\nconst toggle = () => {\n  if (!props.disabled) {\n    emit('update:modelValue', !props.modelValue)\n  }\n}\n</script>\n\n<template>\n  <div\n    class=\"content-stretch flex gap-2 items-center relative shrink-0 cursor-pointer\"\n    :class=\"{ 'opacity-50 cursor-not-allowed': disabled }\"\n    @click=\"toggle\"\n  >\n    <!-- Checkbox Box -->\n    <div\n      :class=\"[\n        'relative shrink-0 size-4 rounded border border-solid',\n        modelValue\n          ? 'bg-[var(--primary-primary,#2877ee)] border-[var(--primary-primary,#2877ee)]'\n          : 'bg-[var(--surface,#ffffff)] border-[var(--primary-primary,#2877ee)]'\n      ]\"\n      data-name=\"Checkbox\"\n    >\n      <!-- Checkmark -->\n      <div\n        v-if=\"modelValue\"\n        class=\"content-stretch flex items-center justify-center overflow-clip relative rounded-[inherit] size-4\"\n      >\n        <svg\n          viewBox=\"0 0 9 7\"\n          fill=\"none\"\n          class=\"w-[9px] h-[6.633px]\"\n        >\n          <path\n            d=\"M1 3.5L3.5 6L8 1\"\n            stroke=\"white\"\n            stroke-width=\"2\"\n            stroke-linecap=\"round\"\n            stroke-linejoin=\"round\"\n          />\n        </svg>\n      </div>\n    </div>\n\n    <!-- Label -->\n    <div\n      v-if=\"label\"\n      class=\"content-stretch flex gap-1 items-center justify-center relative shrink-0\"\n    >\n      <p class=\"font-['Noto_Sans_CJK_TC'] font-medium leading-normal not-italic relative shrink-0 text-base text-[var(--secondary-secondary,#6a6f7b)] text-nowrap whitespace-pre\">\n        {{ label }}\n      </p>\n    </div>\n  </div>\n</template>\n```\n\n## Summary\n\n本設計文檔提供了從 Figma 設計稿到 Vue 元件的完整轉換規劃：\n\n✅ **架構對齊**: Feature-based 模組化設計\n✅ **元件規劃**: 8 個 Shared + 5 個 Feature + 1 個 Page\n✅ **樣式系統**: Tailwind CSS v4 + Figma Design Tokens\n✅ **測試策略**: Playwright MCP 視覺回歸測試\n✅ **轉換範例**: React → Vue 語法對照\n✅ **實作階段**: 7 天分階段交付\n\n下一步將創建 **tasks.md**，將設計分解為可執行的開發任務。\n",
  "fileStats": {
    "size": 40503,
    "lines": 1572,
    "lastModified": "2025-11-10T06:01:47.076Z"
  },
  "comments": []
}